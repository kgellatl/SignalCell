---
title: "SignalCellVignette"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(SignalCell)
```

## Load Data

```{r}
load("~/Dropbox (UMass Medical School)/UMASS/GitHub/R/SignalCell/data/tst_dat.Rdata")
sparse_dat <- as(tst_dat, "dgCMatrix")
```

## Construct SingleCellExperiment
### http://bioconductor.org/packages/release/bioc/html/SingleCellExperiment.html
```{r}
sce <- construct_sce(sparse_dat)
class(sce)
sce

get_def_assay(sce)
sce <- set_def_assay(sce, "counts")
# sce <- set_def_assay(sce, "norm")


rm(sparse_dat)
rm(tst_dat)
```

## exprs Like functionality
```{r}
class(sce@assays@data$counts)
head(sce@assays@data$counts)
```


## pData Like functionality
```{r}
sce$Timepoint <- "0hr"
sce$Timepoint[grep("1", colnames(sce))] <- "1hr"

colData(sce)
sce

colData(sce)$label <- sce$Timepoint
colData(sce)

colLabels(sce)

```


## fData Like functionality
```{r}
counts <- apply(sce@assays@data$counts, 1, function(c)sum(c!=0))
rowData(sce)$gene_counts <- counts
rowData(sce) # use for vector annotations
sce@elementMetadata # use for bulk values??
sce
```
## Finding variable genes
```{r}
exp_var_genes <- var_genes(sce, method = "Expression")

sce <- var_genes(sce, method = "Expression", output = "sce")
sce <- var_genes(sce, method = "CV", output = "sce")
sce <- var_genes(sce, method = "PCA", output = "sce")
sce <- var_genes(sce, method = "Gini", output = "sce")


rowData(sce)
colnames(rowData(sce))

```






